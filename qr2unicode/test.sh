#!/bin/sh -eu
# SPDX-License-Identifier: WTFPL
# shellcheck enable=

cd "$(dirname "$0")"

got=$(mktemp sorted.XXXXXX)
trap 'rm "$got"' EXIT


init () {
	./qr2unicode "$@" > "$got"
}

check () {
	diff -u - "$got"
}


# test string
init hello

check <<- EOF
                                                  
                                                  
    ██████████████    ████      ██████████████    
    ██          ██  ████        ██          ██    
    ██  ██████  ██    ██  ████  ██  ██████  ██    
    ██  ██████  ██      ████    ██  ██████  ██    
    ██  ██████  ██  ████    ██  ██  ██████  ██    
    ██          ██          ██  ██          ██    
    ██████████████  ██  ██  ██  ██████████████    
                        ██████                    
    ██  ██  ██  ██    ██  ██        ██    ██      
        ██  ████        ██      ██        ████    
      ██  ██    ██  ██████  ██      ██████████    
    ████    ██                  ██        ██      
      ████  ██  ████    ██  ██  ██  ██            
                    ████████  ██  ██    ██████    
    ██████████████      ████  ██████    ██████    
    ██          ██      ████████  ████            
    ██  ██████  ██  ██  ████  ██████      ████    
    ██  ██████  ██    ██        ████    ████      
    ██  ██████  ██  ██████  ██      ██  ██  ██    
    ██          ██    ██        ██  ██    ██      
    ██████████████  ██████  ██  ████      ████    
                                                  
                                                  
EOF

# test stdin
echo hello | init --stdin

check <<- EOF
                                                  
                                                  
    ██████████████    ████      ██████████████    
    ██          ██  ████        ██          ██    
    ██  ██████  ██    ██  ████  ██  ██████  ██    
    ██  ██████  ██      ████    ██  ██████  ██    
    ██  ██████  ██  ████    ██  ██  ██████  ██    
    ██          ██          ██  ██          ██    
    ██████████████  ██  ██  ██  ██████████████    
                        ██████                    
    ██  ██  ██  ██    ██  ██        ██    ██      
        ██  ████        ██      ██        ████    
      ██  ██    ██  ██████  ██      ██████████    
    ████    ██                  ██        ██      
      ████  ██  ████    ██  ██  ██  ██            
                    ████████  ██  ██    ██████    
    ██████████████      ████  ██████    ██████    
    ██          ██      ████████  ████            
    ██  ██████  ██  ██  ████  ██████      ████    
    ██  ██████  ██    ██        ████    ████      
    ██  ██████  ██  ██████  ██      ██  ██  ██    
    ██          ██    ██        ██  ██    ██      
    ██████████████  ██████  ██  ████      ████    
                                                  
                                                  
EOF

# unicode_small
init --method unicode_small hello

check <<- EOF
█████████████████████████
██ ▄▄▄▄▄ █▀ ▄███ ▄▄▄▄▄ ██
██ █   █ ██▄▀ ▄█ █   █ ██
██ █▄▄▄█ █▄▄██ █ █▄▄▄█ ██
██▄▄▄▄▄▄▄█▄█ ▀ █▄▄▄▄▄▄▄██
██▄█ █ ▀▄██▄▀▄██▀█▄██ ▀██
██▀ █▄▀█▄█▄▄▄█▄█▀█▄▄▄ ▄██
███▄▄█▄█▄▄▀▀ ▀▄▀▄▀▄█▀▀▀██
██ ▄▄▄▄▄ ███  ▀ ▄ ▀█▄▄▄██
██ █   █ █▄▀▄▄█▄  ██▀ ▄██
██ █▄▄▄█ █▄ ▄█▄█▀█ █▄▀▄██
██▄▄▄▄▄▄▄█▄▄▄█▄█▄▄███▄▄██
▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
EOF
